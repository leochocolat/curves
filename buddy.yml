- pipeline: "Development"
  trigger_mode: "MANUAL"
  ref_name: "develop"
  ref_type: "BRANCH"
  target_site_url: "{SITE_URL}"
  actions:
  - action: "Build frontend"
    type: "BUILD"
    docker_image_name: "library/node"
    docker_image_tag: "8"
    execute_commands:
    - "npm install"
    - "npm run release"
    setup_commands:
    - "npm set registry http://npm.shcc.nl"
    - "npm install -g gulp-cli"
    shell: "BASH"
    trigger_condition: "ON_CHANGE_AT_PATH"
    trigger_condition_paths:
    - "/_sources/*"
  - action: "Upload files to CodeDeploy"
    type: "CODE_DEPLOY"
    local_path: "/"
    application_name: "{APPLICATION_NAME}"
    group_name: "{GROUP_NAME}"
    file_exist_behavior: "DISALLOW"
    config_name: "CodeDeployDefault.AllAtOnce"
    region: "eu-central-1"
    deployment_excludes:
    - "/_sources/"
    - "/_docs/"
    - "/_tools/build/"
    - "/auth.json"
    - "/watch"
    - "/.git*"
    - "/.git/"
    - "/buddy.yml"
    - "/*.md"
    - "/.gitignore"
    - "/Gruntfile.js"
    - "/package.json"
    - "/.gitattributes"
    - "/.gitkeep"
    - "/.npm/"
    - "/node_modules/"
    - "/src/"
    trigger_condition: "ALWAYS"
    integration_id: 34331
#  - action: "Upload files"
#    type: "SFTP"
#    input_type: "BUILD_ARTIFACTS"
#    local_path: "/"
#    remote_path: "${upload_path}"
#    login: "${upload_username}"
#    host: "${upload_host}"
#    port: "22"
#    env_key: "id_rsa"
#    authentication_mode: "ENV_KEY"
#    deployment_excludes:
#    - "/_sources/"
#    - "/_tools/"
#    - "/node_modules/"
#    - "/.babelrc"
#    - "/package*"
#    - "/readme.md"
#    - ".gitignore"